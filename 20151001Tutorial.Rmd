---
title: "20151001Tutorial"
author: "David Chiu"
date: "2015¦~10¤ë1¤é"
output: html_document
---

```{r}
data(mtcars)
names(mtcars)
mtcars[,1:3]
cov(mtcars[,1:3])
cor(mtcars[,1:3])

```
```{r}
binom.test(x=92, n=315, p=1/6)

boxplot(mtcars$mpg, mtcars$mpg[mtcars$am==0], ylab = "mpg", names=c("overall","automobile"))
abline(h=mean(mtcars$mpg),lwd=2, col="red")
abline(h=mean(mtcars$mpg[mtcars$am==0]),lwd=2, col="blue")



mpg.mu = mean(mtcars$mpg)
mpg_am = mtcars$mpg[mtcars$am == 0]
t.test(mpg_am,mu = mpg.mu)

boxplot(mtcars$mpg~mtcars$am,ylab='mpg',names=c('automatic','manual'))
abline(h=mean(mtcars$mpg[mtcars$am==0]),lwd=2, col="blue")
abline(h=mean(mtcars$mpg[mtcars$am==1]),lwd=2, col="red")
t.test(mtcars$mpg~mtcars$am)

```

```{r}
data(iris)
str(iris)
# install.packages("rpart")
library("rpart")

fit  = rpart(Species ~ Sepal.Length + Sepal.Width + Petal.Width + Petal.Length, data=iris)
fit
plot(fit, margin = 0.1)

plot(iris$Petal.Width, iris$Petal.Length)

plot(iris$Petal.Width, iris$Petal.Length, col=iris$Species)

abline(v = 0.8, col="red")
abline(v = 1.75, col="blue")


fit2  = rpart(Species ~ ., data=iris)

plot(fit2, margin = 0.1)
text(fit2)

plot(iris$Petal.Width, iris$Petal.Length, col=iris$Species)

abline(h = 2.45, col="red")
abline(v = 1.75, col="blue")

```


```{r}

install.packages("C50")
library("C50")
data(churn)
str(churnTrain)
churnTrain = churnTrain[,! names(churnTrain) %in% c("state", "area_code", "account_length") ]
nrow(churnTrain)

a = sample(c(0,1), 50, replace=TRUE, prob=c(0.8,0.2))
b = 1:50
b[a==0]
b[a==1]
ind <- sample(2, nrow(churnTrain), replace = TRUE, prob=c(0.7, 0.3))
trainset = churnTrain[ind == 1,]
testset = churnTrain[ind == 2,]
library(rpart)
 fit = rpart(churn ~., data=trainset)
plot(fit, margin = 0.1)
text(fit)


install.packages("party")
library(party)
 fit2 = ctree(churn ~., data=trainset)
 plot(fit2)
```
